From 67dfa3943b1cb47ca643b516211fb8777bd8d25e Mon Sep 17 00:00:00 2001
From: Long Dang <long.dang.aj@rvc.renesas.com>
Date: Mon, 14 Nov 2016 19:18:14 +0700
Subject: [PATCH] add out-width and out-height use weston resolution variables
 in bashrc

Signed-off-by: Long Dang <long.dang.aj@rvc.renesas.com>
---
 RZ_scripts/RZ_GST-demo_camera-preview.sh        |  7 +++++--
 RZ_scripts/RZ_GST-demo_encoded-review.sh        | 14 +++++++++++---
 RZ_scripts/RZ_GST-network-demo_receive-video.sh |  5 +++--
 3 files changed, 19 insertions(+), 7 deletions(-)

diff --git a/RZ_scripts/RZ_GST-demo_camera-preview.sh b/RZ_scripts/RZ_GST-demo_camera-preview.sh
index 370954c..2bcf300 100755
--- a/RZ_scripts/RZ_GST-demo_camera-preview.sh
+++ b/RZ_scripts/RZ_GST-demo_camera-preview.sh
@@ -1,7 +1,10 @@
 #!/bin/bash
+source /home/root/.bashrc # get D_WIDTH, D_HEIGHT
+W=`expr 900 \* $D_WIDTH / 1920 / 32 \* 32`
+H=`expr 540 \* $D_HEIGHT / 1080`
 
-gst-launch-1.0 -e \
+gst-launch-1.0 -e --padprobe v:sink --timer \
 v4l2src ! \
 video/x-raw,format=UYVY,width=720,height=480 ! \
 vspmfilter ! video/x-raw,format=BGRA,width=800,height=480 ! \
-waylandsink qos=false
+waylandsink position-x=100 position-y=100 out-width=$W out-height=$H qos=false name=v
diff --git a/RZ_scripts/RZ_GST-demo_encoded-review.sh b/RZ_scripts/RZ_GST-demo_encoded-review.sh
index 0567675..223573b 100755
--- a/RZ_scripts/RZ_GST-demo_encoded-review.sh
+++ b/RZ_scripts/RZ_GST-demo_encoded-review.sh
@@ -1,4 +1,12 @@
 #!/bin/bash
+source /home/root/.bashrc # get D_WIDTH, D_HEIGHT
+
+PX=`expr 100 \* $D_WIDTH / 1920 / 32 \* 32`
+PY=`expr 300 \* $D_HEIGHT / 1080`
+W=`expr 900 \* $D_WIDTH / 1920 / 32 \* 32`
+H=`expr 540 \* $D_HEIGHT / 1080`
+
+PX2=`expr $PX + $W`
 
 if [ -z "$1" ]; then
 	TIME=10	#second
@@ -9,13 +17,13 @@ fi
 function replay()
 {
 	printf "\e[34mPlaying... $1\e[0m\n"
-	gst-launch-1.0 -e filesrc location=$1 ! h264parse ! omxh264dec ! waylandsink position-x=900 position-y=100 out-width=800 out-height=480 qos=false
+	gst-launch-1.0 -e --padprobe v:sink --timer filesrc location=$1 ! h264parse ! omxh264dec ! waylandsink position-x=$PX2 position-y=$PY out-width=$W out-height=$H qos=false name=v
 }
 
 function record()
 {
 	printf "\e[34mRecording... $1\e[0m\n"
-	gst-launch-1.0 -e \
+	gst-launch-1.0 -e --padprobe v:sink --timer \
 	v4l2src num-buffers=$((TIME*30)) ! \
 	video/x-raw,format=UYVY,width=720,height=480 ! \
 	tee name=t t. ! \
@@ -24,7 +32,7 @@ function record()
 	omxh264enc target-bitrate=10485760 ! \
 	filesink location=$1 t. ! \
 	vspmfilter ! video/x-raw,format=BGRA,width=800,height=480 ! \
-	waylandsink position-x=100 position-y=100 qos=false
+	waylandsink position-x=$PX position-y=$PY out-width=$W out-height=$H qos=false name=v
 }
 
 sync
diff --git a/RZ_scripts/RZ_GST-network-demo_receive-video.sh b/RZ_scripts/RZ_GST-network-demo_receive-video.sh
index 74d4714..84bb18c 100755
--- a/RZ_scripts/RZ_GST-network-demo_receive-video.sh
+++ b/RZ_scripts/RZ_GST-network-demo_receive-video.sh
@@ -1,9 +1,10 @@
 #!/bin/bash
+source /home/root/.bashrc # get D_WIDTH, D_HEIGHT
 
-gst-launch-1.0 -e \
+gst-launch-1.0 -e --padprobe v:sink --timer \
 udpsrc port=5000 caps="application/x-rtp" ! \
 queue ! \
 rtph264depay ! \
 h264parse ! \
 omxh264dec ! \
-waylandsink max-lateness=-1 qos=false position_x=0 position_y=0
+waylandsink max-lateness=-1 qos=false position_x=0 position_y=0 out-width=$D_WIDTH out-height=$D_HEIGHT name=v
-- 
1.9.1

